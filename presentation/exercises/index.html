
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../copy-paste/">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.17">
    
    
      
        <title>Exercises - k8s demonstration</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#exercises" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="k8s demonstration" class="md-header__button md-logo" aria-label="k8s demonstration" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            k8s demonstration
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Exercises
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="k8s demonstration" class="md-nav__button md-logo" aria-label="k8s demonstration" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    k8s demonstration
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Kubernetes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Kubernetes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../what_is_k8s/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is Kubernetes?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../what_is_k8s/working_with_k8s/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Working with Kubernetes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Demo app
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Demo app
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../demo_app/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../demo_app/infrastructure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Infrastructure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../demo_app/platform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Platform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../demo_app/the_app/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The App
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lessons/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lessons learned / Challanges
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Presentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Presentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Presentation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../copy-paste/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Copy-Paste
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Exercises
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Exercises
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#verify-access-to-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Verify access to cluster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-pod-running-a-demo-web-server" class="md-nav__link">
    <span class="md-ellipsis">
      Create a pod running a demo web server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-the-web-server" class="md-nav__link">
    <span class="md-ellipsis">
      Access the web server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-better-way-with-deployments-and-services" class="md-nav__link">
    <span class="md-ellipsis">
      A better way with Deployments and Services
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A better way with Deployments and Services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clean-up" class="md-nav__link">
    <span class="md-ellipsis">
      Clean up
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#making-our-deployment-and-service" class="md-nav__link">
    <span class="md-ellipsis">
      Making our deployment and service
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exposing-our-app-externally" class="md-nav__link">
    <span class="md-ellipsis">
      Exposing our app externally
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clean-up_1" class="md-nav__link">
    <span class="md-ellipsis">
      Clean up
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#verify-access-to-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Verify access to cluster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-pod-running-a-demo-web-server" class="md-nav__link">
    <span class="md-ellipsis">
      Create a pod running a demo web server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-the-web-server" class="md-nav__link">
    <span class="md-ellipsis">
      Access the web server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-better-way-with-deployments-and-services" class="md-nav__link">
    <span class="md-ellipsis">
      A better way with Deployments and Services
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A better way with Deployments and Services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clean-up" class="md-nav__link">
    <span class="md-ellipsis">
      Clean up
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#making-our-deployment-and-service" class="md-nav__link">
    <span class="md-ellipsis">
      Making our deployment and service
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exposing-our-app-externally" class="md-nav__link">
    <span class="md-ellipsis">
      Exposing our app externally
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clean-up_1" class="md-nav__link">
    <span class="md-ellipsis">
      Clean up
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="exercises">Exercises</h1>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Remember to activate completions!</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span><span class="w"> </span>&lt;<span class="o">(</span>kubectl<span class="w"> </span>completion<span class="w"> </span>zsh<span class="o">)</span><span class="w">  </span><span class="c1"># Modify as appropriate for other shells</span>
</code></pre></div>
</div>
<h2 id="verify-access-to-cluster">Verify access to cluster</h2>
<p>To verify we have access to the cluster, we'll run</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>cluster-info
</code></pre></div>
<div markdown class="result">

which should result in something like

<div class="highlight"><pre><span></span><code>Kubernetes control plane is running at https://xxx:443
CoreDNS is running at https://xxx:443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy
Metrics-server is running at https://xxx:443/api/v1/namespaces/kube-system/services/https:metrics-server:/proxy
</code></pre></div>

</div>

<p>and</p>
<p><div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>namespaces
</code></pre></div>
which should list some namespaces.</p>
<h2 id="create-a-pod-running-a-demo-web-server">Create a pod running a demo web server</h2>
<p>First, well create a namespace for ourselves:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>create<span class="w"> </span>namespace<span class="w"> </span>&lt;yourname&gt;
</code></pre></div>
<p>We now create a pod in our namespace</p>
<div class="admonition warning">
<p class="admonition-title">Note the <code>---namespace &lt;yourname&gt;</code></p>
</div>
<p><code>kubectl apply --namespace &lt;yourname&gt; -f pod.yaml</code> with
<div class="highlight"><pre><span></span><code><span class="c1"># pod.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello-web</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello-web</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello-web</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginxdemos/hello:plain-text</span>
<span class="w">      </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div></p>
<p>This will run a pod, which we can verify by <code>kubectl get pod --namespace &lt;yourname&gt;</code>, and you'll see something like
<div class="highlight"><pre><span></span><code>NAME        READY   STATUS    RESTARTS   AGE
hello-web   1/1     Running   0          13s
</code></pre></div></p>
<div class="admonition tip">
<p class="admonition-title">Setting default namespace</p>
<p>To avoid typing <code>--namespace &lt;yourname&gt;</code> all the time, you can run
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>config<span class="w"> </span>set-context<span class="w"> </span>--current<span class="w"> </span>--namespace<span class="o">=</span>&lt;yourname&gt;
</code></pre></div></p>
</div>
<h2 id="access-the-web-server">Access the web server</h2>
<p>To access the web server, we need to expose it, meaning, createing a service for it.
While we would normally do this with a YAML manifest (which we will see later), for now, create one with the <code>kubectl expose</code> command.
If you did it correctly, you should now see something like this when listing services
<div class="highlight"><pre><span></span><code>kubectl get services
NAME        TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)   AGE
hello-web   ClusterIP   10.0.251.230   &lt;none&gt;        80/TCP    5s
</code></pre></div></p>
<div class="admonition tip">
<p class="admonition-title">Alternative names and abbreviations</p>
<p>In guides or when using the autocomplete, sometimes you will see different words used for the same thing.
For example, services are sometimes abbreviated svc, as <code>kubectl get svc</code>.
Deployments will sometimes be written as <code>deployments.apps</code>, etc.</p>
</div>
<p>However, even though it is now exposed, we still have no way of visiting the endpoint!
The service only makes the pod accessible internally on the cluster.
To access it from our machines, it must be exposed externally.
Later, we'll look at ingress, but for now, we'll simply port-forward the service:
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>--namespace<span class="w"> </span>&lt;yourname&gt;<span class="w"> </span>port-forward<span class="w"> </span>services/hello-web<span class="w"> </span><span class="m">8080</span>:80
</code></pre></div>
and visit it at <a href="http://localhost:8080">http://localhost:8080</a>.</p>
<h2 id="a-better-way-with-deployments-and-services">A better way with Deployments and Services</h2>
<p>What we have made until now, has been more of a toy example.
In reality, one rarely create pods manually, but rather deployments.</p>
<h3 id="clean-up">Clean up</h3>
<p>First, clean up what we already made.
One could simply delete the entire namespace, but try instead to find all resources in the namespace, and delete them one by one, using commands like</p>
<ul>
<li><code>kubectl get</code></li>
<li><code>kubectl describe</code></li>
<li><code>kubectl delete</code></li>
</ul>
<h3 id="making-our-deployment-and-service">Making our deployment and service</h3>
<div class="admonition info">
<p class="admonition-title">Namespace</p>
<p>For brevity, we here omit the namespace argument.
Make sure to either include it, set the current context, or add it to the manifest YAML files!</p>
</div>
<p>Copy the <code>deployment.yaml</code> and <code>service.yaml</code> from <a href="../copy-paste/">the copy-paste page</a>, and apply them.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want, you can have all resource definitions in the same <code>.yaml</code> file, separated with a <code>---</code>.
However, it is common to separate it into files, for more granular apply/delete control and better organization.</p>
</div>
<p>Verify that there is a deployment and service in the namespace, and run <code>kubectl describe</code> on the deployment and corresponding replicaset.
Check with <code>kubectl get</code> that the pods are created and ready.</p>
<details class="tip">
<summary>Convenience heredocs</summary>
<p>To avoid creating tons of files for simple operations, <a href="https://en.wikipedia.org/wiki/Here_document">heredocs</a> can be convenient.
Simply do
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-<span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<span class="s"># pod.yaml</span>
<span class="s">apiVersion: v1</span>
<span class="s">kind: Pod</span>
<span class="s">metadata:</span>
<span class="s">  name: hello-web</span>
<span class="s">  labels:</span>
<span class="s">    app: hello-web</span>
<span class="s">spec:</span>
<span class="s">  containers:</span>
<span class="s">    - name: hello-web</span>
<span class="s">      image: nginxdemos/hello:plain-text</span>
<span class="s">      ports:</span>
<span class="s">        - containerPort: 80</span>
<span class="s">EOF</span>
</code></pre></div></p>
</details>
<h3 id="exposing-our-app-externally">Exposing our app externally</h3>
<p>There are several ways to expose apps externally.
They all have different strengths and weaknesses;
the interested reader can search for service types, and look at ClusterIP, NodePort, and LoadBalancer.</p>
<p>On our cluster, which is quite normal, we have an <a href="https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/">ingress controller</a>, allowing us to set up <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/">ingresses</a>.
An ingress is essentially a proxy server, that takes many requests coming to the same public IP, and directing them to the appropriate internal service.</p>
<p>Ingresses are, as everything else in Kubernetes, set up usinga YAML manifest:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ingress.yaml</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello-web</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">demo-ingress.&lt;yourname&gt;.&lt;IP&gt;.sslip.io</span>
<span class="w">      </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello-web</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div>
<p>In the above example, we do a small trick.
Since we have no domain name pointing to our cluster yet, we use <a href="sslip.io"><code>sslip.io</code></a> as a DNS.
It simply resolves the IP address in front of <code>sslip.io</code>.</p>
<p>The IP address we put here, is the same as the one we would put into a domain name if we had one.
To find it, we need to find the public IP address of our ingress controller's load balancer<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>.</p>
<p>How to find this, is an exercise for the reader.
Firstly, find the apprpriate namespace;
its name involves <code>ingress</code> and <code>nginx</code>.
Then, find a service of type <code>LoadBalancer</code>.
That load balancer's IP address, is the one to use.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You are now looking into namespaces containing important internals of the cluster.
If you have liberal permissions, thread carefully!
<code>kubectl get</code> and <code>kubectl describe</code> is always safe, but do not use modifying commands.</p>
</div>
<p>Now, you can visit your app at <code>demo-ingress.&lt;yourname&gt;.&lt;IP&gt;.sslip.io</code>.</p>
<h2 id="clean-up_1">Clean up</h2>
<p>When you are finished, clean up everything by deleting your namespace.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>If you did not understand that mouthful, don't worry!&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>